\documentclass{article}
\title{Pure Exploration of Combinatorial Bandits}
\author{Shouyuan Chen}
\date{\today}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Change "article" to "report" to get rid of page number on title page
\usepackage{amsmath,amsfonts,amsthm,amssymb}
\usepackage{setspace}
\usepackage{Tabbing}
\usepackage{fancyhdr}
\usepackage{lastpage} 
\usepackage{extramarks}
\usepackage{chngpage}
\usepackage{soul,color}
\usepackage{graphicx,float,wrapfig}
\usepackage{afterpage}
\usepackage{abstract}
\usepackage{hyperref}

% In case you need to adjust margins:
\topmargin=-0.45in
\evensidemargin=0in
\oddsidemargin=0in
\textwidth=6.5in
\textheight=9.0in
\headsep=0.25in

% Setup the header and footer
\pagestyle{fancy}
%\lhead{\LatexerName}
%\chead{\LectureClassName: \LectureTitle}
%\rhead{\LectureDate}
%\lfoot{\lastxmark}
%\cfoot{}
\rfoot{Page\ \thepage\ of\ \pageref{LastPage}}
\renewcommand\headrulewidth{0.4pt}
\renewcommand\footrulewidth{0.4pt}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Some tools
\newcommand{\junk}[1]{}

\newtheorem{define}{Definition}
\newtheorem{example}{Example}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newtheorem{theorem}{Theorem}


\newcommand{\M}{\mathcal M}
\newcommand{\mmatch}{\mathcal M_{\mathsf{MATCH}}}
\newcommand{\mtop}{\mathcal M_{\mathsf{TOP}m}}
\newcommand{\mbandit}{\mathcal M_{\mathsf{BANDIT}m}}

\newcommand{\diff}{\mathsf{diff}}
\newcommand{\diffvalid}{\prec}
\newcommand{\B}{\mathcal B}
\newcommand{\C}{\mathcal C}
\newcommand{\del}{\backslash}

\newcommand{\RR}{\mathbb R}


\newcommand{\Bopt}{\mathcal B_{\mathsf{opt}}}
\newcommand{\Bmatch}{\mathcal B_{\mathsf{MATCH}}}
\newcommand{\Btop}{\mathcal B_{\mathsf{TOP}m}}
\newcommand{\Bbandit}{\mathcal B_{\mathsf{BANDIT}m}}

\DeclareMathOperator{\rank}{rank}
\DeclareMathOperator{\rad}{rad}
\DeclareMathOperator{\decomp}{decomp}
\DeclareMathOperator{\argmax}{arg\,max}
\DeclareMathOperator{\argmin}{arg\,min}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\begin{spacing}{1.1}
\newpage

\maketitle

\section{Preliminaries}

\subsection{Problems}

Let $n$ be the number of base arms. 
Let $\M \subseteq 2^{[n]}$ be the set of super arms. 


In this note, we consider the following cases of $\M$.

\begin{example}[Explore-$m$]
$\mtop(n)=\{M \subseteq [n] \;|\; |M|=m\}$.
This corresponds to finding the top $m$ arms from $[n]$.
\end{example}

\begin{example}[Explore-$m$-bandits]
Suppose $n=mk$. Then $\mbandit(n)$ contains all subsets $M \subseteq [n]$ with size $m$, such that 
$$ 
M\cap \{ik+1,\ldots, (i+1)k\} = 1, \quad \text{for all } i \in \{0,\ldots, m-1\}.
$$ 
This corresponds to finding the top arms from $m$ bandits, where each bandit has $k$ arms.
\end{example}

\begin{example}[Perfect Matching]
Let $G=(V,E)$ be a bipartite graph and $|E|=n$. 
For simplicity, let each edge $e\in E$ corresponds to a unique integer $i\in [n]$, and vice versa. 
Then $\mmatch(n,G)$ contains all subsets $M \subseteq [n]$ such that $M$ corresponds to a perfect matching in $G$.
\end{example}


\subsection{Diff-Sets}

\begin{define}[Diff-set]
An $n$-diff-set (or diff-set in short) is a pair of sets $c=(c_+,c_-)$, where $c_+\subseteq[n]$, $c_-\subseteq [n]$ and $c_+\cap c_-=\emptyset$.
\end{define}


\begin{define}[Difference of sets]
Given any $M_1\subseteq[n],M_2\subseteq[n]$. We define $M_1\ominus M_2 \triangleq C$, where $C=(C_+,C_-)$ is a diff-set and
$C_+ = M_1 \del M_2$ and $C_- = M_2\del M_1$.
\end{define}

\begin{define}
Denote $\diff[n]$ be the set of all possible $n$-diff-sets.
\end{define}

\begin{define}[Set operations of diff-sets] 
Let $C=(C_+,C_-), D=(D_+,D_-)$ be two diff-sets. 
We define 
$C\cap D \triangleq (C_+\cap D_+, C_-\cap D_-)$
and $C\del D \triangleq (C_+\del D_+, C_-\del D_-)$.

Further, for all $e\in [n]$, $e \in C \Leftrightarrow (e\in C_+)\vee(e\in C_-)$.
And $|C|\triangleq |C_+|+|C_-|$.
\end{define}

\begin{define}[Valid diff-set]
Given a set $M \subseteq [n]$ and a diff-set $C=(C_+,C_-)$, we call $C$ a \emph{valid diff-set} for $M$, iff $C_+ \cap M = \emptyset$ and $C_- \subseteq M$.
In this case, we denote $C\diffvalid M$.
\end{define}

\begin{define}[Negative diff-set]
Given a diff-set $A=(A_+,A_-)$, we define $\neg A=(A_-,A_+)$.
\end{define}


\subsubsection{diff-set operations}

\begin{define}[Operators $\oplus$ and $\ominus$]
Given any $M \subseteq [n]$ and $C \in \diff[n]$.
If $C\diffvalid M$, we define operator $\oplus$ such that $M \oplus C \triangleq M\del C_- \cup C_+ $.
On the other hand if $\neg C\diffvalid M$, we define operator $\ominus$ such that $M \ominus C \triangleq M\oplus (\neg C) = 
M\del C_+ \cup C_- $.
\end{define}


\begin{define}
Given two diff-sets $A=(A_+,A_-)$ and $B=(B_+,B_-)$.
We denote $B \diffvalid A$, if and only if $B_+\cap A_+ = \emptyset$ and $A_+\cap A_-=\emptyset$.
\end{define}

\begin{define}
Given two diff-sets $A=(A_+,A_-)$ and $B=(B_+,B_-)$. 
If $B\diffvalid A$, we define $A\oplus B = ( (A_+\cup B_+)\del(A_-\cup B_-), (A_-\cup B_-)\del(A_+\cup B_+))$.
\end{define}

\begin{lemma}
Given two diff-sets $A=(A_+,A_-)$ and $B=(B_+,B_-)$. 
If $B\diffvalid A$, then 
$A\oplus B$ is a diff-set.
\end{lemma}

\begin{proof}
Let $C=A\oplus B$.
By definition, we have $C_+ = (A_+\cup B_+)\del(A_-\cup B_-)$ and $C_-=(A_-\cup B_-)\del(A_+\cup B_+)$.

We only need to show that $C_+\cap C_-=\emptyset$.
\begin{align*}
	C_+ \cap C_- &= \big((A_+\cup B_+)\del(A_-\cup B_-)\big)\cap\big((A_-\cup B_-)\del(A_+\cup B_+)\big)\\
			     &= (A_+\cup B_+)\cap\big((A_-\cup B_-)\del(A_+\cup B_+) \del (A_-\cup B_-)\big) \\
			     &= \emptyset.
\end{align*}
\end{proof}

\begin{lemma}
\label{lemma:diff-set-algebra}
Given two diff-sets $A=(A_+,A_-)$ and $B=(B_+,B_-)$. 
If there exists $M\subseteq [n]$ such that $A \diffvalid M$, and $B \diffvalid (M\oplus A)$,
then $B \diffvalid A$ and $(M\oplus A \oplus B)\ominus M = A\oplus B$.
\end{lemma}

\begin{proof}
We first show that $B\diffvalid A$.
Since $B \diffvalid (M\oplus A)$, we know that 
$B_+\cap (M\del A_- \cup A_+) = \emptyset$.
Therefore, we have
\begin{align*}
	\emptyset &= B_+\cap (M\del A_-\cup A_+) \\
			  &= (B_+\cap (M\del A_-))\cup (B_+\cap A_+)
\end{align*}
We see that $B_+\cap A_+=\emptyset$.

On the other hand, we have $B_-\subseteq (M\del A_-\cup A_+)$, therefore 
\begin{align*}
	B_-\cap A_- &\subseteq (M\del A_-\cup A_+)\cap A_- \\
				&= (M\del A_- \cap A_-)\cup (A_+\cap A_-) \\
				&= \emptyset.
\end{align*}
Hence we proved that $B\diffvalid A$.

Define $D=(M\oplus A \oplus B)\ominus M$ and write $D=(D_+,D_-)$. Then,
\begin{align*}
D_+ &= (M\oplus A\oplus B) \del M\\ 
    &= (M\del A_-\cup A_+\del B_-\cup B_+) \del M\\
    &= (A_+\cup B_+)\del(A_-\cup B_-).
\end{align*}
Similarly, we have
\begin{align*}
D_- &= M\del (M\oplus A\oplus B)\\ 
    &= M\del (M\del A_-\cup A_+\del B_-\cup B_+)\\
    &= (A_-\cup B_-)\del (A_+\cup B_+).
\end{align*}
\end{proof}

\subsubsection{Diff-set class}

\begin{define}[Decomposition of diff-set]
Given $\B\subseteq \diff[n]$ and $D\in \diff[n]$, 
a decomposition of $D$ on $\B$ is a set $\{b_1,\ldots,b_k\} \subseteq \B$ satisfying the following
\begin{enumerate}
  \item For all $i\in[k]$ and $j\in [k]$, we write $b_i=(b_i^+,b_i^-)$ and $b_j=(b_j^+,b_j^-)$. Then, the following holds
  $b_i^+\cap b_j^+=\emptyset$, $b_i^+\cap b_j^-=\emptyset$, $b_i^-\cap b_j^+ =\emptyset$ and $b_i^-\cap b_j^-=\emptyset$.
  \item $D=b_1 \oplus b_2 \oplus \ldots b_k$.
\end{enumerate}
\end{define}

\begin{lemma}
Given $\B\subseteq \diff[n]$ and $D\in \diff[n]$.
Let $\{b_1,\ldots,b_k\} \subseteq \B$ be a decomposition of $D$ on $\B$.
Then,
\begin{enumerate}
\item Let $D=(D_+,D_-)$ and for all $i \in [k]$, we write $b_i = (b_i^+,b_i^-)$.
	  Then $D_+=b_1^+ \cup \ldots \cup b_k^+$ and $D_-=b_1^-\cup\ldots\cup b_k^-$.
\item For all $M\subseteq [n]$, if $D\diffvalid M$, then, for all $i\in [k]$, we have $b_i \diffvalid M$.
\end{enumerate}
\end{lemma}

\begin{proof}
We prove (1) by induction.
Let $D_i = b_1 \oplus \ldots \oplus b_i$ and write $D_i=(D_i^+, D_i^-)$.
We show that $D_i^+=\bigcup_{j=1}^i b_i^+$ and $D_{i-}=\bigcup_{j=1}^i b_i^-$ for all $i\in[k]$.
For $i=1$, this is trivially true.
Then, assume that this is true for some $i>1$.
By definition $D_{i+1}=D_{i}\oplus b_{i+1}$, hence $D_{i+1}^+=(D_i^+ \cup b_{i+1}^+)\del(D_i^- \cup b_{i+1}^-)$.
Note that 
\begin{align*}
(D_i^-\cup b_{i+1}^-)\cap(D_i^+ \cup b_{i+1}^+) &= (D_i^-\cap D_i^+)\cup(D_i^- \cap b_{i+1}^+)\cup(b_{i+1}^- \cap D_i^+)\cup(b_{i+1}^- \cap b_{i+1}^+)\\
		&= (D_i^- \cap b_{i+1}^+) \cup (b_{i+1}^- \cap D_i^+) \\
		&= \left(\left(\bigcup_{j=1}^i b_{j}^-\right) \cap b_{i+1}^+ \right) \cup \left(\left(\bigcup_{j=1}^i b_{j}^+\right) \cap b_{i+1}^- \right)\\
		&= \emptyset.
\end{align*}
Hence $D_{i+1}^+=D_i^+ \cup b_{i+1}^+$. We can use the same method to show that $D_{i+1}^-=D_i^- \cup b_{i+1}^-$.

Next, we prove (2) using (1).
To show that $b_i\diffvalid M$, we only need to show that $b_i^+ \cap M = \emptyset$ and $b_i^- \subseteq M$.
Since $D\diffvalid M$, we know that $D_+\cap M=\emptyset$ and $D_-\subseteq M$.
By (1), we see that $b_i^+\subseteq D_+$ and $b_i^-\subseteq D_-$.
Therefore, we have $(b_i^+\cap M) \subseteq (D_+\cap M) = \emptyset$ and $b_i^-\subseteq D_- \subseteq M$.

\end{proof}


\begin{define}[diff-set class]
\label{define:diff-class}
Given $\M \subseteq 2^{[n]}$. $\B \subseteq \diff[n]$ is a diff-set class for $\M$, if the following hold.
\begin{enumerate} 
\item $(\emptyset,\emptyset)\not\in \B$.
\item For all $M\in \M$ and for all $b\in \B$, if $b\diffvalid M$, then $M\oplus b \in \M$.
\item For all $M_1 \in \M$ and $M_2\in \M$, where $M_1\not=M_2$. 	
	  Let $D=M_1\ominus M_2$.  
	  Then, there exists a decomposition of $D$ on $\B$.
\end{enumerate}
\end{define}

\begin{define}[Rank of diff-set class]
Let $\B \subseteq [n]$ be a diff-set class for some $\M$. We define
$$
\rank(\B) \triangleq \max_{b \in \B} |b|.
$$
\end{define}

\begin{example}[diff-set class for Explore-$m$]
One diff-set class $\B$ for $\mtop(n)$ is given by
$$
\B=\{(\{b_1\},\{b_2\}) \;|\; b_1\not=b_2, b_1\in[n], b_2\in[n]\}.
$$
Proof omitted.
Further, we see that $\rank(\B)=2$.
\end{example}

\begin{example}[diff-set class for Explore-$m$-badit]
Let $n=mk$.
One diff-set class $\B$ for $\mbandit(n)$ is given by
$$
\B=\{(\{b_1\},\{b_2\}) \;|\; b_1\not=b_2, \exists i\in\{0,\ldots,k-1\}, b_1\in \{ik+1,\ldots, (i+1)k\}, b_2\in\{ik+1,\ldots, (i+1)k\}\}.
$$
Proof omitted.
Further, we see that $\rank(\B)=2$.
\end{example}


\begin{example}[diff-set class for Perfect Matching]
One diff-set class $\B$ for $\mmatch(n, G)$ is the set of all augmenting cycles of $G$. 
More specifically,
$$
\B=\{(b_+,b_-) | b_+\cup b_- \text{ is a cycle of } G\}.
$$

Note $\rank(\B)\le n$.
\end{example}

\subsection{Weights and confidence bounds}

\begin{define}[Weight functions]
Define function $w: [n] \rightarrow \RR^+$ which represents the weight of each base arm. 
Further, we slight abuse the notations, and extend the definition of $w$ to diff-sets and sets as follows.
\begin{enumerate}
\item For all $M \subseteq [n]$, we denote $w(M) = \sum_{e\in M} w(e)$.
\item For all $b=(b_+,b_-) \in \diff[n]$, we denote $w(b) = \sum_{e\in b_+} w(e)-\sum_{e\in b_-}w(e)$.
\end{enumerate}
\end{define}


\begin{lemma}
\label{lemma:weight-diff-simple}
Let $c\in \diff[n],d\in \diff[n]$. Let $w$ be a weight function.
Then,
\begin{equation}
w(c\cup d) = w(c)+w(d)-w(c\cap d).
\end{equation}
\end{lemma}

\begin{proof}
Let $c=(c_+,c_-)$ and $d=(d_+,d_-)$.
We have
\begin{align}
w(c\cup d) &= w(c_+\cup d_+)-w(c_-\cup d_-)\\
           &= w(c_+)+w(d_+)-w(c_+\cap d_+)-w(c_-)-w(d_-)+w(c_- \cap d_-)\\
           &= w(c)+w(d)-(w(c_+\cap d_+)-w(c_-\cap d_-))\\
           &= w(c)+w(d)-w(c\cap d).
\end{align}
\end{proof}

\begin{define}[Mean weight $\bar w_t$, sample size $n_t$]
Given $t>0$. 
Define $\bar w_t$ be a weight function such that, for all $e\in[n]$, $\bar w_t(e)$ equals to the empirical mean of $e$ up to round $t$.
Let $n_t: [n] \rightarrow \mathbb N$, such that $n_t(e)$ equals to number of plays of base arm $e$ up to round $t$.
\end{define}

\begin{define}[Confidence radius $\rad_t$]
Given $n$ and $t>0$.
Define $\rad_t:[n]\rightarrow \RR^+$ satisfying, for all $e\in[n]$,
$$
\rad_t(e) = c_{\rad}\log\left(\frac{c_\delta nt^2}\delta\right)\frac{1}{\sqrt{n_t(e)}},
$$
where $c_{\rad} > 0$  and $c_\delta>0$ are some universal constants (specify later) and $\delta > 0$ is a parameter.

We extend the notation of $\rad_t$ to diff-sets and sets as follows.
\begin{enumerate}
\item For all $M \subseteq [n]$, $\rad_t(M) \triangleq \sum_{e\in M} \rad_t(e)$.
\item For all $b=(b_+,b_-)\in \diff[n]$, $\rad_t(b) \triangleq \rad_t(b_+)+\rad_t(b_-)$.
\end{enumerate}

\end{define}

\begin{define}[UCB $w_t^+$]
Define $w^+_t: [n] \rightarrow \RR^+$, s.t., for all $e\in[n]$,  
$$ w^+_t(e)=\bar w_t(e)+\rad_t(e).$$

We extend the notation of $w_t^+$ to diff-sets and sets as follows.
\begin{enumerate}
\item For all $M \subseteq [n]$, $w_t^+(M) \triangleq \bar w_t(M)+\rad_t(M)$.
\item For all $b=(b_+,b_-)\in \diff[n]$, $w_t^+(b) \triangleq \bar w_t(b)+\rad_t(b)$.
\end{enumerate}

\end{define}

\begin{lemma}
\label{lemma:conf}
Define random event 
$$
\xi = \left\{\forall e\in[n]\; \forall t>0, |\bar w_t(e)-w(e)|\le \rad_t(e) \right\}.
$$
Then, there exist constants $c_{\rad}$ and $c_\delta$,
$$
\Pr[\xi] \ge 1-\delta.
$$
\end{lemma}
\begin{proof}
Hoeffding inequality and union bound.
\end{proof}



\begin{corollary}
\label{corr:conf}
$$
\xi \implies \forall t,\forall e\in[n] \; w_t^+(e) \ge w(e).
$$
$$
\xi \implies \forall t,\forall M\subseteq[n],\; w_t^+(M) \ge w(M).
$$
$$
\xi \implies \forall t,\forall b\in\diff[n]\; w_t^+(b) \ge w(b).
$$
\end{corollary}

\junk{
\begin{lemma}
Let $c\in \diff[n],d\in \diff[n]$. Let $\rad_t$ be a radius function.
Then,
\begin{equation}
\rad_t(c\cup d) = \rad_t(c)+\rad_t(d)-\rad_t(c\cap d).
\end{equation}
\end{lemma}

\begin{proof}
Let $c=(c_+,c_-)$ and $d=(d_+,d_-)$.
We have
\begin{align}
\rad_t(c\cup d) &= \rad_t(c_+\cup d_+) + \rad_t(c_-\cup d_-)\\
			  &= \rad_t(c_+)+\rad_t(d_+)-\rad_t(c_+\cap d_+)
			    +\rad_t(c_-)+\rad_t(d_-)-\rad_t(c_-\cap d_-)\\
			  &= \rad_t(c)+\rad_t(d)-\rad_t(c\cap d).
\end{align}
\end{proof}
}

\subsection{Properties of $\rad_t$}

\begin{lemma}
\label{lemma:rad-diff-simple}
Let $c\in \diff[n],d\in \diff[n]$.
Then
\begin{equation}
\rad_t(c\del d) = \rad_t(c)-\rad_t(c\cap d).
\end{equation}
\end{lemma}

\begin{proof}
Let $c=(c_+,c_-)$ and $d=(d_+,d_-)$.
We have
\begin{align*}
\rad_t(c\del d) &= \rad_t(c_+\del d_+)+\rad_t(c_-\del d_-)\\
			    &= \rad_t(c_+)-\rad_t(c_+\cap d_+)+\rad_t(c_-)-\rad_t(c_-\cap d_-)\\
			    &= \rad_t(c)-\rad_t(c\cap d).
\end{align*}

\end{proof}


\begin{lemma}
\label{lemma:diff-algebra-rad}

Let $C=(C_+,C_-)$ and $D=(D_+,D_-)$ be two diff-sets.
If $D \diffvalid C$, then
$$
\rad_t(C \oplus D) = \rad_t(C)+\rad_t(D)-2\rad_t(C_+ \cap D_-)-2\rad_t(C_- \cap D_+).
$$

In addition, if $\neg D \diffvalid C$, then
$$
\rad_t(C \ominus D) = \rad_t(C)+\rad_t(D)-2\rad_t(C_+ \cap D_+)-2\rad_t(C_- \cap D_-).
$$
\end{lemma}

\begin{proof}
We prove the first part of the lemma. The second part follows from the first part and the definition of $\neg D$.

By definition, we have $C\oplus D = ( (C_+ \cup D_+) \del (C_-\cup D_-), (C_-\cup D_-) \del (C_+\cup D_+) )$.
Hence, we have 
\begin{align}
\rad_t((C_+ \cup D_+) \del (C_-\cup D_-)) &= \rad_t(C_+ \cup D_+)-\rad_t( (C_+\cup D_+)\cap(C_-\cup D_-)) \\
							              &= \rad_t(C_+)+\rad_t(D_+)-\rad_t( (C_+\cup D_+)\cap(C_-\cup D_-)),						
\end{align}
where the second equality holds due to $C_+\cap D_+=\emptyset$ by the definition of $D\diffvalid C$.

Similarly, we have
$$
\rad_t((C_- \cup D_-) \del (C_+\cup D_+)) = \rad_t(C_-)+\rad_t(D_-)-\rad_t( (C_+\cup D_+) \cap(C_-\cup D_-)).
$$

Combine both equalities, we have
\begin{align}
  \rad_t(C \oplus D) &= \rad_t((C_+ \cup D_+) \del (C_-\cup D_))+\rad_t((C_- \cup D_-) \del (C_-\cap D_+))\\
  				     &=	\rad_t(C_+)+\rad_t(D_+)+\rad_t(C_-)+\rad_t(D_-)-2\rad_t( (C_+\cup D_+) \cap(C_-\cup D_-))\\
  				     &= \rad_t(C)+\rad_t(D)-2\rad_t( (C_+\cup D_+) \cap(C_-\cup D_-)).
\end{align}


\end{proof}


\section{Algorithm and Main Results}

\subsection{Algorithm}
\begin{enumerate}
\item Input Parameter: $\delta \in (0,1)$.
\item For $t=1,\ldots, $
\item Maintain $\bar w_t$ and $\rad_t$.
\item Let $M_t = \argmax_{M\in \M} \bar w_t(M)$. 
\item Let $D=\argmax_{C \in \diff[n], C \diffvalid M_t} w_t^+(C)$. 
\item If $w_t^+(D) \le 0$. Then stop and return $M_t$.
\item Otherwise, find $p_t = \argmin_{e\in D} \rad_t(e)$.
\item Play $p_t$.
\item Go back to step 2.
\end{enumerate}

The step 5 of above procedure can be implemented by:
\begin{enumerate}
\item Let $M_t^+ = \argmax_{M\in \M} \tilde w_t(M)$, where $\tilde w_t$ is a weight function defined by:
	\begin{enumerate}
		\item $\forall e\in M_t$, $\tilde w_t(e) = \bar w_t(e)-\rad_t(e)$.
		\item $\forall e\not \in M_t$, $\tilde w_t(e) = \bar w_t(e)+\rad_t(e)$.
	\end{enumerate}
\item $D = M_t^+\ominus M_t$
\end{enumerate}

\subsection{Main result}

\begin{define}[Optimal diff-sets]
Given a diff-set class $\B$ and the optimal set $M_*$.
We define $\Bopt$ as a subset of $\B$, and for all $b\in \B$, $b\in \Bopt$ if and only if,
there exists $M\not=M_*$ and $M_* \ominus M$ can be decomposed as $b,b_1,\ldots,b_k$ on $\B$.
\end{define}

\begin{define}[Hardness $\Delta_e$ of base arm $e$]
For each $e\in [n]$, we define its hardness $\Delta_e$ as follows
$$
\Delta_e = \min_{b\in \Bopt, e\in b} \frac{1}{\rank(\B)} w(b).
$$
\end{define}

\begin{define}[Sufficient exploration]
For all $t>0$, we define $E_t^3 \subseteq [n]$, such that, for all $e\in[n]$
$e\in E_t^3$ if and only if $\rad_t(e) < \frac{1}{3} \Delta_e$.
\end{define}

\begin{corollary}
For all $t>0$ and $e\in[n]$
$$ n_t(e) \ge O(\frac{1}{\Delta_e^2}\log(\Delta_e n/\delta)) \implies e\in E_t^3.$$
\end{corollary}

\begin{theorem}
With probability at least $1-\delta$,
the algorithm returns $M_*$,
and the number of samples used by the algorithm are at most
$$
\sum_{e\in [n]} \Delta_e^{-2}\log(\Delta_e n/\delta).
$$
\end{theorem}


\section{Proof of Main Results}
Unless specified, we shall assume the random event $\xi$ (defined in Lemma~\ref{lemma:conf}) holds in all the following proofs.


\begin{lemma}
\label{lemma:correct}
For any $t>0$, if the algorithm terminates on round $t$, then $M_t=M_*$.
\end{lemma}

\begin{proof}
Suppose $M_t \not= M_*$. Then $w(M_*)>w(M_t)$. 
Then, there exists $b \in \B$ such that $b \diffvalid M_t$ and $w(b)>0$.
On the other hand, by Corollary~\ref{corr:conf}, we have $w_t^+(b) > w(b)$.
Hence $w_t^+(b)>0$. This contradicts to the stopping condition of our algorithm.
\end{proof}

\begin{lemma}
For any $t>0$.
If $e\in E_t^3$, then $p_t\not= e$.
\end{lemma}

\begin{proof}
Suppose that $p_t=e$. 
Let $D = M_t^+ \ominus M_t$.
Let $c,c_1,\ldots,c_k$ be decomposition of $D$ on $\B$. 
And since $\B$ is a diff-set class, such decomposition exists.
Assume, without loss of generality, that $e\in c$.

By Lemma~Y, we know that 
\begin{equation}
	\label{eq:lemma-key-1}
	D_+ = c_+\cup c_1^+ \cup \ldots \cup c_k^+\quad \text{and}\quad D_- = c_-\cup c_1^-\cup \ldots c_k^-.
\end{equation}

We also denote $K=\rank(\B)$.


\textbf{Case (1).} 
Suppose that $c \in\Bopt$. Then $w(c)>0$.
Since $e\in E_t^3$, we have $\rad_t(e) \le \frac{1}{3}\Delta_e \le \frac{1}{3K}w(c)$.
In addition, $\forall g\in c_t, g\not=e$, $\rad_t(g) \le \rad_t(e)\le \frac{1}{3K}w(c)$.
Hence, $\rad_t(c) = \sum_{g\in c_t} \rad_t(g) \le \frac{|c_t|}{3K}w(c) \le \frac{1}{3}w(c)$.

Hence, $\bar w_t(c) \ge w(c)-\rad_t(c) \ge \frac{2}{3}w(c) > 0$.
This means that $\bar w_t(M_t \oplus c) = \bar w_t(M_t)+\bar w_t(c) > \bar w_t(M_t)$.
Therefore, $M_t \not= \max_{M\in \M} \bar w_t(M)$.
This contradicts to the definition of $M_t$.

\textbf{Case (2).} 
Suppose that $c_t\not\in \Bopt$. Then, one of the following mutually exclusive cases must hold.

\textbf{Case (2.1).} 
$(e \in M_* \wedge e\in c_+)$ or $(e \not \in M_* \wedge e\in c_-)$. 
 
Let the decomposition of $M_* \ominus (M_t \oplus D \ominus c)$ on $\B$ be $b,b_1,\ldots,b_l$, which exists due to $\B$ is a diff-set class. 
Assume wlog that $e\in b$. 
We write $b=(b_+,b_-)$.
It is easy to see that $b \in \Bopt$. 

Define $\tilde D = (M_t \oplus D \ominus c)\ominus M_t$ and $D' = (M_t \oplus \tilde D \oplus b) \ominus M_t$.
By Lemma~\ref{lemma:diff-set-algebra}, we know that $\tilde D = D\ominus c$ and $D'=\tilde D\oplus b$.
We also write $\tilde D=(\tilde D_+, \tilde D_-)$ and $D'= (D'_+, D'_-)$.
By definition, we have 
\begin{align*}
	\tilde D_+ &= (D_+ \cup c_-)\del (D_- \cup c_+)\\
	           &= (D_+\cup c_-\del D_-) \cap (D_+\cup c_-\del c_+)\\
	           &= D_+ \cap (D_+\del c_-) \\
	           &= D_+\del c_+.
\end{align*}
By the same method, we are able to show that $\tilde D_-=D_-\del c_-$.
Therefore we have 
\begin{equation}
\label{eq:2.1.0.1}
\tilde D_+\subseteq D_+\quad\text{and}\quad\tilde D_-\subseteq D_-.
\end{equation}

First, we show that $\rad_t(c) \le \frac13 w(b)$.
Since $e\in E_t^3$, $e\in b$ and $b\in \Bopt$, we have $\rad_t(e) \le \frac{1}{3}\Delta_e \le \frac{1}{3K}w(b)$.
In addition, $\forall g\in c, g\not=e$, $\rad_t(g) \le \rad_t(e)\le \frac{1}{3K}w(b)$.
Hence, 
\begin{align}
\rad_t(c) &= \sum_{g\in c} \rad_t(g) \nonumber \\
		  & \le \frac{|c|}{3K}w(b) \nonumber \\
		  &\le \frac{1}{3}w(b).\label{eq:2.1.0.2}
\end{align}

%Consider the diff-set $D'=D\ominus c \oplus b$.
Now, we show that $\rad_t(\tilde D_+ \cap b_-)+\rad_t(\tilde D_- \cap b_+)+ \le \frac13 w(b)$.
Since Eq.~\eqref{eq:2.1.0.1}, we have $\forall g\in (\tilde D_+\cap b_-)\cup(\tilde D_-\cap b_+), g\not=e$, 
$\rad_t(g) \le \rad_t(e)\le \frac{1}{3K}w(b)$.
Note that $|\tilde D_+\cap b_-|+|\tilde D_-\cap b_+|\le |b_+|+|b_-| \le K$. 
Hence, 
\begin{align}
\rad_t(\tilde D_+ \cap b_-)+\rad_t(\tilde D_- \cap b_+) &= \sum_{g\in (\tilde D_+\cap b_-)\cup(\tilde D_-\cap b_+)} \rad_t(g) \nonumber\\
	& \le \frac{K}{3K}w(b) \nonumber \\
	& \le \frac{1}{3}w(b). \label{eq:2.1.0.3}
\end{align}

Then, we have
\begin{align}
\rad_t(D')-\rad_t(D) &= \rad_t(\tilde D \oplus b)-\rad_t(D) \\
					 &= \rad_t(\tilde D)+\rad_t(b)-2\rad_t(\tilde D_+\cap b_-)-2\rad_t(\tilde D_-\cap b_+)-\rad_t(D)
					 \label{eq:2.1.1}\\
					 &= \rad_t(D\ominus c)+\rad_t(b)-2\rad_t(\tilde D_+\cap b_-)-2\rad_t(\tilde D_-\cap b_+)-\rad_t(D)\\
					 &= \rad_t(D)+\rad_t(c)+\rad_t(b)-2\rad_t(D_+\cap c_+)-2\rad_t(D_-\cap c_-) \nonumber \\
					 &\quad -2\rad_t(\tilde D_+\cap b_-)-2\rad_t(\tilde D_-\cap b_+)-\rad_t(D)
					 \label{eq:2.1.2}\\
					 &= \rad_t(D)+\rad_t(c)+\rad_t(b)-2\rad_t(c_+)-2\rad_t(c_-) \nonumber \\
					 &\quad -2\rad_t(\tilde D_+\cap b_-)-2\rad_t(\tilde D_-\cap b_+)-\rad_t(D)
					 \label{eq:2.1.3}\\
					 &= \rad_t(b)-\rad_t(c)-2\rad_t(\tilde D_+\cap b_-)-2\rad_t(\tilde D_-\cap b_+),
\end{align}
where Eq.~\eqref{eq:2.1.1} and Eq.~\eqref{eq:2.1.2} follow from Lemma~\ref{lemma:diff-algebra-rad}, and 
Eq.~\eqref{eq:2.1.3} follows from Eq.~\eqref{eq:lemma-key-1}.

By the definition of $D$, we have that $w^+_t(D) \ge w^+_t(D')$. 
This means that 
\begin{align}
	\bar w_t(D)+\rad_t(D) &\ge \bar w_t(D')+\rad_t(D')\\
						  &= \bar w_t(D)-\bar w_t(c)+\bar w_t(b)+\rad_t(D').
\end{align}
By regrouping the above inequality, we have
\begin{align}
   \bar w_t(c) &\ge \bar w_t(b) + \rad_t(D')-\rad_t(D) \\
   			   &= \bar w_t(b)+\rad_t(b)-\rad_t(c)-2\rad_t(\tilde D_+\cap b_-)-2\rad_t(\tilde D_-\cap b_+)\\
   			   &\ge w(b)-\rad_t(c)-2\rad_t(\tilde D_+\cap b_-)-2\rad_t(\tilde D_-\cap b_+) \\
   			   &> w(b)-\frac13 w(b)-\frac23 w(b) \label{eq:2.1.4}\\
   			   &= 0,
\end{align}
where Eq.~\eqref{eq:2.1.4} follows from Eq.~\eqref{eq:2.1.0.2} and Eq.~\eqref{eq:2.1.0.3}.

This contradicts to the definition of $M_t$.

\textbf{Case (2.2).}
$(e \in M_* \wedge e\in c_-)$ or $(e \not \in M_* \wedge e\in c_+)$.

Let the decomposition of $M_* \ominus (M_t\oplus D)$ on $\B$ be $b,b_1,\ldots, b_l$.
Assume wlog that $e\in b$.
We write that $b=(b_+,b_-)$.
Note that $b\in \Bopt$ and hence $w(b)>0$.

Define $D'=(M_t\oplus D\oplus b)\ominus M_t$. By Lemma~\ref{lemma:diff-set-algebra}, we know that $D' = D\oplus b$.

First, we show that $|D\del D'| \le |b|$.
Let $C=D\del D'$ and write $C=(C_+,C_-)$.
We can bound $|C_+|$ as follows.
\begin{align*}
	C_+ &= D_+\del D'_+\\
		&= D_+\del \left((D_+\cup b_+) \del (D_-\cup b_-)\right)\\
		&= (D_+ \cap (D_-\cup b_-)) \cup (D_+ \del (D_+\cup b_+))\\
		&= D_+\cap b_-.
\end{align*}
Hence, we have $|C_+| \le |b_-|$.
Then, we move to bounding $|C_-|$
\begin{align*}
	C_- &= D_-\del D'_-\\
		&= D_-\del \left((D_-\cup b_-) \del (D_+\cup b_+)\right)\\
		&= (D_- \cap (D_+\cup b_+)) \cup (D_- \del (D_-\cup b_-))\\
		&= D_-\cap b_+.
\end{align*}
Thus $|C_-|\le |b_-|$ and we proved that $|D\del D'|\le |b|$.


Next, we show that $\rad_t(D \del D') \le \frac13 w(b)$.
Since $e\in E_t^3$, $e\in b$ and $b\in \Bopt$, we have $\rad_t(e) \le \frac{1}{3}\Delta_e \le \frac{1}{3K}w(b)$.
In addition, $\forall g\in (D \del D'), g\not=e$, $\rad_t(g) \le \rad_t(e)\le \frac{1}{3K}w(b)$.
Note that $|D\del D'| \le |b| \le K$.
Hence, $\rad_t(D\del D') = \sum_{g\in (D\del D')} \rad_t(g) \le \frac{K}{3K}w(b) \le \frac{1}{3}w(b)$.

We also note that
\begin{align}
w(D'\del D)-w(D\del D') &= w(D' \del D)+w(D'\cap D)-w(D\cap D')-w(D\del D')\\
						&= w(D')-w(D) \\
						&= w(b),
\end{align}
where we have repeatedly applied Lemma~\ref{lemma:weight-diff-simple}.

Then, we show that $w^+_t(D') > w^+_t(D)$.
\begin{align}
	w_t^+(D')-w_t^+(D) &= \bar w_t(D')-\bar w_t(D)+\rad_t(D')-\rad_t(D)\\
					   &= \bar w_t(D'\del D)-\bar w_t(D\del D')+\rad_t(D'\del D)-\rad_t(D\del D') \label{eq:2.2.x.1} \\
					   &\ge w(D'\del D)-w(D\del D')-2\rad_t(D\del D') \label{eq:2.2.x.2} \\
					   &= w(b)-2\rad_t(D\del D')\\
					   &> w(b)-\frac23 w(b) \\
					   &= \frac13 w(b) > 0,
\end{align}
where Eq.~\eqref{eq:2.2.x.1} follows from Lemma~\ref{lemma:rad-diff-simple} and Eq.~\eqref{eq:2.2.x.2} follows from
the fact that $\bar w_t(D'\del D)+\rad_t(D'\del D)\ge w(D'\del D)$ and that $\bar w_t(D\del D')+\rad_t(D\del D')\ge w(D\del D')$, under the random event $\xi$.

This contradicts to the fact that $D$ is chosen on round $t$.
\end{proof}


%\bibliography{bandit}
%\bibliographystyle{abbrv}
\end{spacing}
\end{document}